
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>PySpark Programming for Big Data &#8212; IanFang Course Note Hosting  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/nature.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="canonical" href="https://uwf-fang.github.io/big_data/pyspark.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Module 5: Data Analysis for Big Data" href="../course/idc6145/m05.html" />
    <link rel="prev" title="PySpark Environment For Learning" href="pyspark_colab_env.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../course/idc6145/m05.html" title="Module 5: Data Analysis for Big Data"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pyspark_colab_env.html" title="PySpark Environment For Learning"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">IanFang Course Note Hosting  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../course/idc6145/index.html" >IDC 6145 Big Data for Data Science</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../course/idc6145/m04.html" accesskey="U">Module 4: PySpark Programming For Beginner</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">PySpark Programming for Big Data</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="pyspark-programming-for-big-data">
<h1>PySpark Programming for Big Data<a class="headerlink" href="#pyspark-programming-for-big-data" title="Permalink to this heading">¶</a></h1>
<p>We will only briefly introduce how to program in PySpark to manipulate datasets
and achieve certain big data processing tasks.</p>
<section id="pyspark-basics">
<h2>PySpark Basics<a class="headerlink" href="#pyspark-basics" title="Permalink to this heading">¶</a></h2>
<ul>
<li><p>Concepts</p>
<dl class="simple glossary">
<dt id="term-SparkContext">SparkContext<a class="headerlink" href="#term-SparkContext" title="Permalink to this term">¶</a></dt><dd><p>Entry point to most of the PySpark functionalities.</p>
</dd>
<dt id="term-RDD-Resilient-Distributed-Dataset">RDD (Resilient Distributed Dataset)<a class="headerlink" href="#term-RDD-Resilient-Distributed-Dataset" title="Permalink to this term">¶</a></dt><dd><p>A fundamental building block of PySpark which is fault-tolerant, immutable distributed collection of objects</p>
</dd>
<dt id="term-DataFrame">DataFrame<a class="headerlink" href="#term-DataFrame" title="Permalink to this term">¶</a></dt><dd><p>A distributed collection of data organized into named columns. Optional
in this course.</p>
</dd>
<dt id="term-DataSet">DataSet<a class="headerlink" href="#term-DataSet" title="Permalink to this term">¶</a></dt><dd><p>Similar to DataFrame but with strict types. Optional in this course.</p>
</dd>
</dl>
</li>
</ul>
<section id="why-rdd-only-here">
<h3>Why RDD only here?<a class="headerlink" href="#why-rdd-only-here" title="Permalink to this heading">¶</a></h3>
<p>The DataFrame and DataSet APIs are optional as it is not a typical way in big
data processing where data are mostly not structured. They are both closer to
either the SQL or the Pandas way of data manipulation and can be learned easily
if you are familiar with them.</p>
<p>On the other hand, RDD is the fundamental data API that provides more
capability to work with unstructured/semi-structured data. It the unique way to
work with big data in PySpark and is the focus here.</p>
</section>
</section>
<section id="related-python-concepts">
<h2>Related Python Concepts<a class="headerlink" href="#related-python-concepts" title="Permalink to this heading">¶</a></h2>
<p>As the programming language used in PySpark is Python, we will need to know
some Python concepts to work with PySpark. Please refer to the Python
programming resources online if you are not familiar with Python.</p>
<p>We will learn some useful python concepts to be used in data manipulation using
PySpark APIs.</p>
<section id="lambda-functions">
<h3>Lambda Functions<a class="headerlink" href="#lambda-functions" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>A simple and disposable way to write a python function.</p></li>
<li><p>Many RDD transformations require a function as its parameter</p></li>
<li><p>Syntax</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">&lt;input</span> <span class="pre">list&gt;:</span> <span class="pre">&lt;return</span> <span class="pre">value&gt;</span></code></p></li>
<li><p>start with <code class="docutils literal notranslate"><span class="pre">lambda</span></code> keyword</p></li>
<li><p>followed by a list of parameters</p></li>
<li><p>after the colon, provide the return value calculated based on the
parameters</p></li>
</ul>
</li>
<li><p>Examples</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">x:</span> <span class="pre">x*x</span></code>, square the input</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">line:</span> <span class="pre">line.split()</span></code>, split a text to a list of text using spaces
as delimiters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">paragraph:</span> <span class="pre">paragraph.split('\n')</span></code>, split a text to a list of
lines using new line character as delimiters</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">word:</span> <span class="pre">(word,</span> <span class="pre">1)</span></code>, convert a work to a key-value pair of word and
1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">word:</span> <span class="pre">len(word)</span></code>, convert a string to its length</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">pair:</span> <span class="pre">pair[0]</span></code>, return the first element of the pair</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">pair:</span> <span class="pre">pair[1]</span></code>, return the second element of the pair</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">x,</span> <span class="pre">y:</span> <span class="pre">x+y</span></code>, sum up two value</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">p1,</span> <span class="pre">p2:</span> <span class="pre">p1[1]</span> <span class="pre">+</span> <span class="pre">p2[1]</span></code>, sum up the second values in two pairs</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section id="rdd-resilient-distributed-dataset">
<h2>RDD (Resilient Distributed Dataset)<a class="headerlink" href="#rdd-resilient-distributed-dataset" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>External readings</p>
<ul>
<li><p><a class="reference external" href="https://spark.apache.org/docs/latest/rdd-programming-guide.html">RDD Programming Guide</a></p></li>
<li><p><a class="reference external" href="https://www.analyticsvidhya.com/blog/2021/10/a-comprehensive-guide-to-pyspark-rdd-operations/">A Comprehensive Guide to PySpark RDD Operations</a></p></li>
</ul>
</li>
</ul>
<ul>
<li><p>Characteristics</p>
<ul class="simple">
<li><p>Distributed (data is distributed across multiple machines)</p></li>
<li><p>Immutable (once created, it cannot be changed)</p></li>
<li><p>Lazy evaluation (transformations are not executed until an action is
called)</p></li>
</ul>
</li>
<li><p>Two types of operations</p>
<ul class="simple">
<li><p>As extensions to traditional map/reduce paradigm</p></li>
<li><p>Transformations</p>
<ul>
<li><p>Takes an RDD and return another RDD</p></li>
<li><p>Distributed RDD to distributed RDD</p></li>
<li><p>Can be chained</p></li>
<li><p>Include but more than just mapping</p></li>
</ul>
</li>
<li><p>Actions</p>
<ul>
<li><p>Take an RDD and return a single object</p></li>
<li><p>Distributed RDD to local object</p></li>
<li><p>Include but more than just reducing</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Useful transformations</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">map(func)</span></code>, func should transform one item to another</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">flatMap(func)</span></code>, func should take one item and generate a list</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">filter(func)</span></code>, func should return True or False according to the input</p></li>
</ul>
</li>
<li><p>Useful actions</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">collect()</span></code>, collect all data and return a local list, be careful with
large dataset</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">count()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">first()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">take(num)</span></code>, take the first num of values and return a local list</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reduce(func)</span></code>, func should take two parameters and give one result</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sum()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mean()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">countByValue()</span></code></p>
<ul>
<li><p>Python dict like type as output <code class="docutils literal notranslate"><span class="pre">{key1:</span> <span class="pre">value1,</span> <span class="pre">key2:</span> <span class="pre">value2,</span> <span class="pre">...}</span></code></p></li>
<li><p>models key-value pair</p></li>
<li><p>key must be unique</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Pair RDD</p>
<p>PySpark provides a specialized group of operations for working with Pair
RDDs. In PySpark, pair RDDs are a specialized subtype of the RDD data
structure that take the form of key-value pairs.</p>
<ul class="simple">
<li><p>example <code class="docutils literal notranslate"><span class="pre">[(key1,</span> <span class="pre">value1),</span> <span class="pre">(key2,</span> <span class="pre">value2),</span> <span class="pre">...]</span></code></p></li>
<li><p>Useful transformations for pair RDDs</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">sortByKey(ascending=True)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sortBy(func,</span> <span class="pre">ascending=True)</span></code></p>
<ul>
<li><p>func should take an item and return the value used to perform sorting</p></li>
<li><p>e.g. <code class="docutils literal notranslate"><span class="pre">pairs.sortBy(lambda</span> <span class="pre">p:</span> <span class="pre">p[1])</span></code> use the value (second item in the
pair) to sort the pairs</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">groupByKey()</span></code></p>
<ul>
<li><p>create a new RDD with each item being pairs with a same key</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Useful actions for pair RDDs</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">reduceByKey(func)</span></code></p>
<ul>
<li><p>func should take two values (second item in the pair) and return one</p></li>
<li><p>used to combine values that have a same key</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">countByKey()</span></code></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">PySpark Programming for Big Data</a><ul>
<li><a class="reference internal" href="#pyspark-basics">PySpark Basics</a><ul>
<li><a class="reference internal" href="#why-rdd-only-here">Why RDD only here?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#related-python-concepts">Related Python Concepts</a><ul>
<li><a class="reference internal" href="#lambda-functions">Lambda Functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rdd-resilient-distributed-dataset">RDD (Resilient Distributed Dataset)</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="pyspark_colab_env.html"
                          title="previous chapter">PySpark Environment For Learning</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../course/idc6145/m05.html"
                          title="next chapter">Module 5: Data Analysis for Big Data</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/big_data/pyspark.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../course/idc6145/m05.html" title="Module 5: Data Analysis for Big Data"
             >next</a> |</li>
        <li class="right" >
          <a href="pyspark_colab_env.html" title="PySpark Environment For Learning"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">IanFang Course Note Hosting  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../course/idc6145/index.html" >IDC 6145 Big Data for Data Science</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../course/idc6145/m04.html" >Module 4: PySpark Programming For Beginner</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">PySpark Programming for Big Data</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021-2024, Ian Fang.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>
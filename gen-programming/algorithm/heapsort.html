
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Heap Sort &#8212; IanFang Course Note Hosting  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/nature.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://uwf-fang.github.io/gen-programming/algorithm/heapsort.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Module 13 Brute-Force and Backtracking Algorithm" href="../../course/cop3530/m13.html" />
    <link rel="prev" title="Heap and Heap Sort" href="../../cpp/heap.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../course/cop3530/m13.html" title="Module 13 Brute-Force and Backtracking Algorithm"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../cpp/heap.html" title="Heap and Heap Sort"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">IanFang Course Note Hosting  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../course/cop3530/index.html" >COP 3530 Data Structure and Algorithm Design</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../course/cop3530/m12.html" accesskey="U">Module 12 Heap and Priority Queue</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Heap Sort</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="heap-sort">
<h1>Heap Sort<a class="headerlink" href="#heap-sort" title="Permalink to this heading">¶</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h2>
<p>Heap sort is a comparison based sorting technique based on Binary Heap data
structure. It is similar to selection sort where we first find the maximum
element and place the maximum element at the end. We repeat the same process
for remaining element.</p>
<p>It is first developed by J.W.J. Williams in 1964.</p>
</section>
<section id="characteristics">
<h2>Characteristics<a class="headerlink" href="#characteristics" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Comparison based (general purpose)</p></li>
<li><p>Iterative</p></li>
<li><p>In-place</p></li>
<li><p>Efficient <span class="math notranslate nohighlight">\(\Theta(n \log n)\)</span></p></li>
<li><p>Unstable - relative order of equal elements is not preserved</p></li>
</ul>
</section>
<section id="algorithm-details">
<h2>Algorithm Details<a class="headerlink" href="#algorithm-details" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Heapify the array to build a heap</p></li>
<li><p>Removing the root node repeatedly from a heap</p>
<ul class="simple">
<li><p>move root to the sorted region by swapping it with the last leaf</p></li>
<li><p>percolate the root down</p></li>
</ul>
</li>
</ol>
</section>
<section id="pseudo-code">
<h2>Pseudo Code<a class="headerlink" href="#pseudo-code" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">function</span> <span class="n">heapSort</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
  <span class="n">n</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>

  <span class="c1"># Heapify the array</span>
  <span class="k">for</span> <span class="n">i</span> <span class="kn">from</span> <span class="nn">n</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span> <span class="n">down</span> <span class="n">to</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">percolateDown</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

  <span class="c1"># Extract elements from the heap one by one</span>
  <span class="k">for</span> <span class="n">i</span> <span class="kn">from</span> <span class="nn">n</span> <span class="o">-</span> <span class="mi">1</span> <span class="n">down</span> <span class="n">to</span> <span class="mi">1</span><span class="p">:</span>
    <span class="c1"># Swap the root (maximum element) with the last element</span>
    <span class="n">swap</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">percolateDown</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>


<span class="n">function</span> <span class="n">percolateDown</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
  <span class="n">largest</span> <span class="o">:=</span> <span class="n">i</span>
  <span class="n">left</span> <span class="o">:=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="n">right</span> <span class="o">:=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span>

  <span class="c1"># Compare with left child</span>
  <span class="k">if</span> <span class="n">left</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="ow">and</span> <span class="n">arr</span><span class="p">[</span><span class="n">left</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">arr</span><span class="p">[</span><span class="n">largest</span><span class="p">]:</span>
    <span class="n">largest</span> <span class="o">:=</span> <span class="n">left</span>

  <span class="c1"># Compare with right child</span>
  <span class="k">if</span> <span class="n">right</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="ow">and</span> <span class="n">arr</span><span class="p">[</span><span class="n">right</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">arr</span><span class="p">[</span><span class="n">largest</span><span class="p">]:</span>
    <span class="n">largest</span> <span class="o">:=</span> <span class="n">right</span>

  <span class="c1"># If the largest element is not the root, swap them</span>
  <span class="k">if</span> <span class="n">largest</span> <span class="o">!=</span> <span class="n">i</span><span class="p">:</span>
    <span class="n">swap</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">arr</span><span class="p">[</span><span class="n">largest</span><span class="p">])</span>

    <span class="c1"># Recursively percolate down the affected sub-tree</span>
    <span class="n">percolateDown</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">largest</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="complexity">
<h2>Complexity<a class="headerlink" href="#complexity" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Time <span class="math notranslate nohighlight">\(\Theta(n \log n)\)</span></p></li>
<li><p>Space <span class="math notranslate nohighlight">\(\Theta(1)\)</span> as an in-place algorithm</p></li>
</ul>
</section>
<section id="visualization">
<h2>Visualization<a class="headerlink" href="#visualization" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.cs.usfca.edu/~galles/visualization/HeapSort.html">https://www.cs.usfca.edu/~galles/visualization/HeapSort.html</a></p></li>
</ul>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Heap Sort</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#characteristics">Characteristics</a></li>
<li><a class="reference internal" href="#algorithm-details">Algorithm Details</a></li>
<li><a class="reference internal" href="#pseudo-code">Pseudo Code</a></li>
<li><a class="reference internal" href="#complexity">Complexity</a></li>
<li><a class="reference internal" href="#visualization">Visualization</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../../cpp/heap.html"
                          title="previous chapter">Heap and Heap Sort</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../../course/cop3530/m13.html"
                          title="next chapter">Module 13 Brute-Force and Backtracking Algorithm</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/gen-programming/algorithm/heapsort.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../course/cop3530/m13.html" title="Module 13 Brute-Force and Backtracking Algorithm"
             >next</a> |</li>
        <li class="right" >
          <a href="../../cpp/heap.html" title="Heap and Heap Sort"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">IanFang Course Note Hosting  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../course/cop3530/index.html" >COP 3530 Data Structure and Algorithm Design</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../course/cop3530/m12.html" >Module 12 Heap and Priority Queue</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Heap Sort</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021-2024, Ian Fang.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.3.0.
    </div>
  </body>
</html>